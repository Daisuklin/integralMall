<!doctype html>
<html>

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width">
		<title>鼠标拾取地图坐标</title>
		<link rel="stylesheet" href="http://cache.amap.com/lbs/static/main1119.css" />
		<script type="text/javascript" src="http://webapi.amap.com/maps?v=1.4.5&key=您申请的key值&plugin=AMap.Autocomplete"></script>
		<script type="text/javascript" src="http://cache.amap.com/lbs/static/addToolbar.js"></script>
	</head>

	<body>
		<div id="container"></div>
		<div id="myPageTop">
			<table>
				<tr>
					<td>
						<label>按关键字搜索：</label>
					</td>
					<td class="column2">
						<label>左击获取经纬度：</label>
					</td>
				</tr>
				<tr>
					<td>
						<input type="text" placeholder="请输入关键字进行搜索" id="tipinput">
					</td>
					<td class="column2">
						<input type="text" readonly="true" id="lnglat">
					</td>
				</tr>
			</table>
		</div>
		<script type="text/javascript">
			var map = new AMap.Map("container", {
				resizeEnable: true
			});
			//  var marker, map = new AMap.Map("container", {
			//      resizeEnable: true,
			//      center: [116.397428, 39.90923],
			//      zoom: 13
			//  });
			//为地图注册click事件获取鼠标点击出的经纬度坐标
			var clickEventListener = map.on('click', function(e) {
				var getLng = e.lnglat.getLng(); //经度
				var getLat = e.lnglat.getLat(); //纬度
				document.getElementById("lnglat").value = e.lnglat.getLng() + ',' + e.lnglat.getLat()
				console.info("e.lnglat.getLng()", e.lnglat.getLng(), "e.lnglat.getLat()", e.lnglat.getLat())
				updateMarker(getLng, getLat);
			});
			var auto = new AMap.Autocomplete({
				input: "tipinput"
			});
			AMap.event.addListener(auto, "select", select); //注册监听，当选中某条记录时会触发
			function select(e) {
				if(e.poi && e.poi.location) {
					map.setZoom(15);
					map.setCenter(e.poi.location);
				}
			}

			function updateMarker(getLng, getLat) {
				marker = new AMap.Marker({
					icon: "http://webapi.amap.com/theme/v1.3/markers/n/mark_b.png",
					position: [getLng, getLat]
				});
				marker.setMap(map);
				console.info("map", map)

				// 自定义点标记内容
				var markerContent = document.createElement("div");
				// 点标记中的图标
				var markerImg = document.createElement("img");
				markerImg.className = "markerlnglat";
				markerImg.src = "http://webapi.amap.com/theme/v1.3/markers/n/mark_r.png";
				markerContent.appendChild(markerImg);
				marker.setContent(markerContent); //更新点标记内容
				marker.setPosition([getLng, getLat]); //更新点标记位置
			}
		</script>
	</body>

</html>